[package]
name = "lib-infrastructure-instrumentation-opentelemetry"
version = "0.1.0"
authors.workspace = true
edition.workspace = true

[features]
default = ["http-proto"]
http-proto = ["opentelemetry-otlp/http-proto"]
http-json = ["opentelemetry-otlp/http-json"]
grpc-tonic = ["opentelemetry-otlp/grpc-tonic"]

[dependencies]
stdout = { path = "../stdout", package = "lib-infrastructure-instrumentation-stdout" }

metrics.workspace = true
tap.workspace = true
tokio.workspace = true
tracing.workspace = true
tracing-subscriber = { workspace = true, features = ["env-filter"] }

metrics-exporter-otel = "0.2.0"
metrics-process = "2.4.1"
metrics-tracing-context = "0.18.1"
metrics-util = "0.20.0"
opentelemetry = { version = "0.30.0", features = ["trace", "logs", "metrics"] }
opentelemetry_sdk = { version = "0.30.0", features = [
  "rt-tokio",
  "trace",
  "logs",
  "metrics",
  "experimental_metrics_custom_reader",
  "experimental_metrics_periodicreader_with_async_runtime",
] }
opentelemetry-appender-tracing = { version = "0.30.1", features = [
  "experimental_metadata_attributes",
  #    "spec_unstable_logs_enabled",
  "experimental_use_tracing_span_context",
] }
opentelemetry-otlp = { version = "0.30.0", default-features = false, features = [
  "trace",
  "logs",
  "metrics",
] }
opentelemetry-semantic-conventions = { version = "0.30.0", features = [
  "semconv_experimental",
] }
tokio-metrics = { version = "0.4.5", features = [
  "rt",
  "metrics-rs-integration",
] }
tracing-opentelemetry = "0.31.0"

[dev-dependencies]
tokio = { workspace = true, features = [
  "macros",
  "test-util",
  "rt-multi-thread",
] }
opentelemetry-otlp = { version = "0.30.0", features = ["http-proto"] }

[lints]
workspace = true
